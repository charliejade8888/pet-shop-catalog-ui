{"ast":null,"code":"var _jsxFileName = \"/home/charliejade/dev/apps/Pet Shop/pet-shop-catalog-ui/src/index.js\";\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport * as Keycloak from 'keycloak-js';\nimport $ from \"jQuery\";\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\n//keycloak init options\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nlet initOptions = {\n  url: 'http://localhost:8180/',\n  // realm: 'react-realm', \n  realm: 'petshoprealm',\n  clientId: 'react-login-client',\n  onLoad: 'login-required'\n};\nlet keycloak = Keycloak(initOptions);\nkeycloak.init({\n  onLoad: initOptions.onLoad\n}).success(auth => {\n  if (!auth) {\n    window.location.reload();\n  } else {\n    console.info(\"Authenticated\");\n  }\n  sessionStorage.setItem(\"keycloak\", keycloak.tokenParsed.exp);\n  sessionStorage.setItem(\"bearer-token\", keycloak.token);\n  sessionStorage.setItem(\"refresh-token\", keycloak.refreshToken);\n  // console.log(keycloak.token);\n\n  setTimeout(() => {\n    keycloak.updateToken(70).success(refreshed => {\n      if (refreshed) {\n        console.debug('Token refreshed' + refreshed);\n      } else {\n        console.warn('Token not refreshed, valid for ' + Math.round(keycloak.tokenParsed.exp + keycloak.timeSkew - new Date().getTime() / 1000) + ' seconds');\n      }\n    }).error(() => {\n      console.error('Failed to refresh token');\n    });\n  }, 60000);\n}).error(() => {\n  console.error(\"Authenticated Failed\");\n});\nfunction LogOut() {\n  const logout = () => {\n    sessionStorage.clear();\n    window.location.href = 'http://localhost:8180/realms/petshoprealm/protocol/openid-connect/logout';\n  };\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: logout,\n      children: \"Logout\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 9\n    }, this)\n  }, void 0, false);\n}\n\n// ReactDOM.render(<LogOut />, document.getElementById(\"logoutBtn\"));\n_c = LogOut;\nfunction CheckRoles() {\n  const check = () => {\n    $.ajax({\n      type: \"GET\",\n      url: \"http://localhost:9000/catalog/list?pageNo=1&pageSize=10\",\n      headers: {\n        'Authorization': 'Bearer ' + localStorage.getItem(\"bearer-token\")\n        //   'Access-Control-Allow-Origin' : '*'\n      },\n\n      success: function (data1) {\n        document.getElementById(\"admin\").innerHTML = data1;\n      },\n      error: function (error) {\n        document.getElementById(\"admin\").innerHTML = \"You dont have admin privilages\";\n      }\n    });\n    // $.ajax({\n    //   type: \"GET\",\n    //   url: \"http://localhost:8080/check/admin\",\n    //   headers : {\n    //      'Authorization': 'Bearer ' + localStorage.getItem(\"bearer-token\")\n    //   },\n    //   success: function (data1) {\n    //     document.getElementById(\"admin\").innerHTML = data1;\n    //   },\n    //   error: function (error) {\n    //     document.getElementById(\"admin\").innerHTML = \"You dont have admin privilages\";\n    //   }\n    // });\n\n    // $.ajax({\n    //   type: \"GET\",\n    //   url: \"http://localhost:8080/check/customer\",\n    //   headers : {\n    //      'Authorization': 'Bearer ' + localStorage.getItem(\"bearer-token\")\n    //   },\n    //   success: function (data2) {\n    //     document.getElementById(\"cust\").innerHTML = data2;\n    //   },\n    //   error: function (error) {\n    //     document.getElementById(\"cust\").innerHTML = \"You dont have customer privilages\";\n    //   }\n    // });\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"p\", {\n      children: [\" Check Admin privilages at \", /*#__PURE__*/_jsxDEV(\"strong\", {\n        children: \"/check/admin\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 126,\n        columnNumber: 37\n      }, this), \" and check Customer privilages at \", /*#__PURE__*/_jsxDEV(\"strong\", {\n        children: \"/check/customer\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 126,\n        columnNumber: 100\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: check,\n      children: \"Check\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      id: \"admin\",\n      children: \" \"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      id: \"cust\",\n      children: \" \"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n}\n_c2 = CheckRoles;\nReactDOM.render( /*#__PURE__*/_jsxDEV(App, {}, void 0, false, {\n  fileName: _jsxFileName,\n  lineNumber: 137,\n  columnNumber: 17\n}, this), document.getElementById('root'));\nserviceWorker.unregister();\n\n// ReactDOM.render(<CheckRoles />, document.getElementById(\"root\"));\nvar _c, _c2;\n$RefreshReg$(_c, \"LogOut\");\n$RefreshReg$(_c2, \"CheckRoles\");","map":{"version":3,"names":["React","ReactDOM","Keycloak","$","App","serviceWorker","jsxDEV","_jsxDEV","Fragment","_Fragment","initOptions","url","realm","clientId","onLoad","keycloak","init","success","auth","window","location","reload","console","info","sessionStorage","setItem","tokenParsed","exp","token","refreshToken","setTimeout","updateToken","refreshed","debug","warn","Math","round","timeSkew","Date","getTime","error","LogOut","logout","clear","href","children","onClick","fileName","_jsxFileName","lineNumber","columnNumber","_c","CheckRoles","check","ajax","type","headers","localStorage","getItem","data1","document","getElementById","innerHTML","id","_c2","render","unregister","$RefreshReg$"],"sources":["/home/charliejade/dev/apps/Pet Shop/pet-shop-catalog-ui/src/index.js"],"sourcesContent":["import React from 'react';\nimport ReactDOM from 'react-dom';\nimport * as Keycloak from 'keycloak-js'\nimport $ from \"jQuery\";\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\n\n//keycloak init options\nlet initOptions = {\n    url: 'http://localhost:8180/', \n    // realm: 'react-realm', \n     realm: 'petshoprealm', \n    clientId: 'react-login-client', \n    onLoad: 'login-required'\n}\n\n\nlet keycloak = Keycloak(initOptions);\n\nkeycloak.init({ onLoad: initOptions.onLoad }).success((auth) => {\n\n    if (!auth) {\n        window.location.reload();\n    } else {\n        console.info(\"Authenticated\");\n    }\n\n    \n    sessionStorage.setItem(\"keycloak\", keycloak.tokenParsed.exp);\n    sessionStorage.setItem(\"bearer-token\", keycloak.token);\n    sessionStorage.setItem(\"refresh-token\", keycloak.refreshToken);\n    // console.log(keycloak.token);\n\n    setTimeout(() => {\n        keycloak.updateToken(70).success((refreshed) => {\n            if (refreshed) {\n                console.debug('Token refreshed' + refreshed);\n            } else {\n                console.warn('Token not refreshed, valid for '\n                    + Math.round(keycloak.tokenParsed.exp + keycloak.timeSkew - new Date().getTime() / 1000) + ' seconds');\n            }\n        }).error(() => {\n            console.error('Failed to refresh token');\n        });\n\n\n    }, 60000)\n\n}).error(() => {\n    console.error(\"Authenticated Failed\");\n});\n\n\n\nfunction LogOut(){\n    const logout = ()=>{\n      sessionStorage.clear();\n        window.location.href = 'http://localhost:8180/realms/petshoprealm/protocol/openid-connect/logout';\n    };\n\n    return (\n     <>\n        <button  onClick={logout}>\n          Logout\n        </button>\n    </>\n\n    );\n}\n\n// ReactDOM.render(<LogOut />, document.getElementById(\"logoutBtn\"));\n\n\n\nfunction CheckRoles() {\n  const check = () => {\n    $.ajax({\n      type: \"GET\",\n      url: \"http://localhost:9000/catalog/list?pageNo=1&pageSize=10\",\n      headers : {\n         'Authorization': 'Bearer ' + localStorage.getItem(\"bearer-token\"),\n      //   'Access-Control-Allow-Origin' : '*'\n      },\n      success: function (data1) {\n        document.getElementById(\"admin\").innerHTML = data1;\n      },\n      error: function (error) {\n        document.getElementById(\"admin\").innerHTML = \"You dont have admin privilages\";\n      }\n    });\n    // $.ajax({\n    //   type: \"GET\",\n    //   url: \"http://localhost:8080/check/admin\",\n    //   headers : {\n    //      'Authorization': 'Bearer ' + localStorage.getItem(\"bearer-token\")\n    //   },\n    //   success: function (data1) {\n    //     document.getElementById(\"admin\").innerHTML = data1;\n    //   },\n    //   error: function (error) {\n    //     document.getElementById(\"admin\").innerHTML = \"You dont have admin privilages\";\n    //   }\n    // });\n\n    // $.ajax({\n    //   type: \"GET\",\n    //   url: \"http://localhost:8080/check/customer\",\n    //   headers : {\n    //      'Authorization': 'Bearer ' + localStorage.getItem(\"bearer-token\")\n    //   },\n    //   success: function (data2) {\n    //     document.getElementById(\"cust\").innerHTML = data2;\n    //   },\n    //   error: function (error) {\n    //     document.getElementById(\"cust\").innerHTML = \"You dont have customer privilages\";\n    //   }\n    // });\n\n\n  };\n\n  return (\n    <>\n      <p> Check Admin privilages at <strong>/check/admin</strong> and check Customer privilages at <strong>/check/customer</strong>\n      </p>\n      <button onClick={check} >\n        Check \n      </button>\n      <p id=\"admin\"> </p>\n      <p id=\"cust\"> </p>\n    </>\n  );\n}\n\nReactDOM.render(<App />, document.getElementById('root'));\nserviceWorker.unregister();\n\n// ReactDOM.render(<CheckRoles />, document.getElementById(\"root\"));\n\n\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}