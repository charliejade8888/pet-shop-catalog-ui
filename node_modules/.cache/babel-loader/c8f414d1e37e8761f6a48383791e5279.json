{"ast":null,"code":"var _jsxFileName = \"/home/charliejade/dev/apps/Pet Shop/front end (copy 1)/react-keycloak/src/index.js\";\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport * as Keycloak from 'keycloak-js';\nimport $ from \"jQuery\";\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker'; //keycloak init options\n\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nlet initOptions = {\n  url: 'http://localhost:8180/',\n  // realm: 'react-realm', \n  realm: 'petshoprealm',\n  clientId: 'react-login-client',\n  onLoad: 'login-required'\n};\nlet keycloak = Keycloak(initOptions);\nkeycloak.init({\n  onLoad: initOptions.onLoad\n}).success(auth => {\n  if (!auth) {\n    window.location.reload();\n  } else {\n    console.info(\"Authenticated\");\n  }\n\n  sessionStorage.setItem(\"bearer-token\", keycloak.token);\n  sessionStorage.setItem(\"refresh-token\", keycloak.refreshToken);\n  console.log(keycloak.token);\n  setTimeout(() => {\n    keycloak.updateToken(70).success(refreshed => {\n      if (refreshed) {\n        console.debug('Token refreshed' + refreshed);\n      } else {\n        console.warn('Token not refreshed, valid for ' + Math.round(keycloak.tokenParsed.exp + keycloak.timeSkew - new Date().getTime() / 1000) + ' seconds');\n      }\n    }).error(() => {\n      console.error('Failed to refresh token');\n    });\n  }, 60000);\n}).error(() => {\n  console.error(\"Authenticated Failed\");\n});\n\nfunction LogOut() {\n  const logout = () => {\n    sessionStorage.clear();\n    window.location.href = 'http://localhost:8180/realms/petshoprealm/protocol/openid-connect/logout';\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: logout,\n      children: \"Logout\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 9\n    }, this)\n  }, void 0, false);\n} // ReactDOM.render(<LogOut />, document.getElementById(\"logoutBtn\"));\n\n\n_c = LogOut;\n\nfunction CheckRoles() {\n  const check = () => {\n    $.ajax({\n      type: \"GET\",\n      url: \"http://localhost:9000/catalog/list?pageNo=1&pageSize=10\",\n      headers: {\n        'Authorization': 'Bearer ' + localStorage.getItem(\"bearer-token\") //   'Access-Control-Allow-Origin' : '*'\n\n      },\n      success: function (data1) {\n        document.getElementById(\"admin\").innerHTML = data1;\n      },\n      error: function (error) {\n        document.getElementById(\"admin\").innerHTML = \"You dont have admin privilages\";\n      }\n    }); // $.ajax({\n    //   type: \"GET\",\n    //   url: \"http://localhost:8080/check/admin\",\n    //   headers : {\n    //      'Authorization': 'Bearer ' + localStorage.getItem(\"bearer-token\")\n    //   },\n    //   success: function (data1) {\n    //     document.getElementById(\"admin\").innerHTML = data1;\n    //   },\n    //   error: function (error) {\n    //     document.getElementById(\"admin\").innerHTML = \"You dont have admin privilages\";\n    //   }\n    // });\n    // $.ajax({\n    //   type: \"GET\",\n    //   url: \"http://localhost:8080/check/customer\",\n    //   headers : {\n    //      'Authorization': 'Bearer ' + localStorage.getItem(\"bearer-token\")\n    //   },\n    //   success: function (data2) {\n    //     document.getElementById(\"cust\").innerHTML = data2;\n    //   },\n    //   error: function (error) {\n    //     document.getElementById(\"cust\").innerHTML = \"You dont have customer privilages\";\n    //   }\n    // });\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"p\", {\n      children: [\" Check Admin privilages at \", /*#__PURE__*/_jsxDEV(\"strong\", {\n        children: \"/check/admin\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 124,\n        columnNumber: 37\n      }, this), \" and check Customer privilages at \", /*#__PURE__*/_jsxDEV(\"strong\", {\n        children: \"/check/customer\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 124,\n        columnNumber: 100\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: check,\n      children: \"Check\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      id: \"admin\",\n      children: \" \"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      id: \"cust\",\n      children: \" \"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n}\n\n_c2 = CheckRoles;\nReactDOM.render( /*#__PURE__*/_jsxDEV(App, {}, void 0, false, {\n  fileName: _jsxFileName,\n  lineNumber: 135,\n  columnNumber: 17\n}, this), document.getElementById('root'));\nserviceWorker.unregister(); // ReactDOM.render(<CheckRoles />, document.getElementById(\"root\"));\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"LogOut\");\n$RefreshReg$(_c2, \"CheckRoles\");","map":{"version":3,"sources":["/home/charliejade/dev/apps/Pet Shop/front end (copy 1)/react-keycloak/src/index.js"],"names":["React","ReactDOM","Keycloak","$","App","serviceWorker","initOptions","url","realm","clientId","onLoad","keycloak","init","success","auth","window","location","reload","console","info","sessionStorage","setItem","token","refreshToken","log","setTimeout","updateToken","refreshed","debug","warn","Math","round","tokenParsed","exp","timeSkew","Date","getTime","error","LogOut","logout","clear","href","CheckRoles","check","ajax","type","headers","localStorage","getItem","data1","document","getElementById","innerHTML","render","unregister"],"mappings":";AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,QAAP,MAAqB,WAArB;AACA,OAAO,KAAKC,QAAZ,MAA0B,aAA1B;AACA,OAAOC,CAAP,MAAc,QAAd;AACA,OAAO,aAAP;AACA,OAAOC,GAAP,MAAgB,OAAhB;AACA,OAAO,KAAKC,aAAZ,MAA+B,iBAA/B,C,CAGA;;;;AACA,IAAIC,WAAW,GAAG;AACdC,EAAAA,GAAG,EAAE,wBADS;AAEd;AACCC,EAAAA,KAAK,EAAE,cAHM;AAIdC,EAAAA,QAAQ,EAAE,oBAJI;AAKdC,EAAAA,MAAM,EAAE;AALM,CAAlB;AASA,IAAIC,QAAQ,GAAGT,QAAQ,CAACI,WAAD,CAAvB;AAEAK,QAAQ,CAACC,IAAT,CAAc;AAAEF,EAAAA,MAAM,EAAEJ,WAAW,CAACI;AAAtB,CAAd,EAA8CG,OAA9C,CAAuDC,IAAD,IAAU;AAE5D,MAAI,CAACA,IAAL,EAAW;AACPC,IAAAA,MAAM,CAACC,QAAP,CAAgBC,MAAhB;AACH,GAFD,MAEO;AACHC,IAAAA,OAAO,CAACC,IAAR,CAAa,eAAb;AACH;;AAEDC,EAAAA,cAAc,CAACC,OAAf,CAAuB,cAAvB,EAAuCV,QAAQ,CAACW,KAAhD;AACAF,EAAAA,cAAc,CAACC,OAAf,CAAuB,eAAvB,EAAwCV,QAAQ,CAACY,YAAjD;AACAL,EAAAA,OAAO,CAACM,GAAR,CAAYb,QAAQ,CAACW,KAArB;AAEAG,EAAAA,UAAU,CAAC,MAAM;AACbd,IAAAA,QAAQ,CAACe,WAAT,CAAqB,EAArB,EAAyBb,OAAzB,CAAkCc,SAAD,IAAe;AAC5C,UAAIA,SAAJ,EAAe;AACXT,QAAAA,OAAO,CAACU,KAAR,CAAc,oBAAoBD,SAAlC;AACH,OAFD,MAEO;AACHT,QAAAA,OAAO,CAACW,IAAR,CAAa,oCACPC,IAAI,CAACC,KAAL,CAAWpB,QAAQ,CAACqB,WAAT,CAAqBC,GAArB,GAA2BtB,QAAQ,CAACuB,QAApC,GAA+C,IAAIC,IAAJ,GAAWC,OAAX,KAAuB,IAAjF,CADO,GACkF,UAD/F;AAEH;AACJ,KAPD,EAOGC,KAPH,CAOS,MAAM;AACXnB,MAAAA,OAAO,CAACmB,KAAR,CAAc,yBAAd;AACH,KATD;AAYH,GAbS,EAaP,KAbO,CAAV;AAeH,CA3BD,EA2BGA,KA3BH,CA2BS,MAAM;AACXnB,EAAAA,OAAO,CAACmB,KAAR,CAAc,sBAAd;AACH,CA7BD;;AAiCA,SAASC,MAAT,GAAiB;AACb,QAAMC,MAAM,GAAG,MAAI;AACjBnB,IAAAA,cAAc,CAACoB,KAAf;AACEzB,IAAAA,MAAM,CAACC,QAAP,CAAgByB,IAAhB,GAAuB,0EAAvB;AACH,GAHD;;AAKA,sBACC;AAAA,2BACG;AAAS,MAAA,OAAO,EAAEF,MAAlB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AADH,mBADD;AAQH,C,CAED;;;KAhBSD,M;;AAoBT,SAASI,UAAT,GAAsB;AACpB,QAAMC,KAAK,GAAG,MAAM;AAClBxC,IAAAA,CAAC,CAACyC,IAAF,CAAO;AACLC,MAAAA,IAAI,EAAE,KADD;AAELtC,MAAAA,GAAG,EAAE,yDAFA;AAGLuC,MAAAA,OAAO,EAAG;AACP,yBAAiB,YAAYC,YAAY,CAACC,OAAb,CAAqB,cAArB,CADtB,CAEV;;AAFU,OAHL;AAOLnC,MAAAA,OAAO,EAAE,UAAUoC,KAAV,EAAiB;AACxBC,QAAAA,QAAQ,CAACC,cAAT,CAAwB,OAAxB,EAAiCC,SAAjC,GAA6CH,KAA7C;AACD,OATI;AAULZ,MAAAA,KAAK,EAAE,UAAUA,KAAV,EAAiB;AACtBa,QAAAA,QAAQ,CAACC,cAAT,CAAwB,OAAxB,EAAiCC,SAAjC,GAA6C,gCAA7C;AACD;AAZI,KAAP,EADkB,CAelB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGD,GA5CD;;AA8CA,sBACE;AAAA,4BACE;AAAA,6DAA8B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cAA9B,qDAA6F;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cAA7F;AAAA;AAAA;AAAA;AAAA;AAAA,YADF,eAGE;AAAQ,MAAA,OAAO,EAAET,KAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YAHF,eAME;AAAG,MAAA,EAAE,EAAC,OAAN;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YANF,eAOE;AAAG,MAAA,EAAE,EAAC,MAAN;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YAPF;AAAA,kBADF;AAWD;;MA1DQD,U;AA4DTzC,QAAQ,CAACoD,MAAT,eAAgB,QAAC,GAAD;AAAA;AAAA;AAAA;AAAA,QAAhB,EAAyBH,QAAQ,CAACC,cAAT,CAAwB,MAAxB,CAAzB;AACA9C,aAAa,CAACiD,UAAd,G,CAEA","sourcesContent":["import React from 'react';\nimport ReactDOM from 'react-dom';\nimport * as Keycloak from 'keycloak-js'\nimport $ from \"jQuery\";\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\n\n//keycloak init options\nlet initOptions = {\n    url: 'http://localhost:8180/', \n    // realm: 'react-realm', \n     realm: 'petshoprealm', \n    clientId: 'react-login-client', \n    onLoad: 'login-required'\n}\n\n\nlet keycloak = Keycloak(initOptions);\n\nkeycloak.init({ onLoad: initOptions.onLoad }).success((auth) => {\n\n    if (!auth) {\n        window.location.reload();\n    } else {\n        console.info(\"Authenticated\");\n    }\n\n    sessionStorage.setItem(\"bearer-token\", keycloak.token);\n    sessionStorage.setItem(\"refresh-token\", keycloak.refreshToken);\n    console.log(keycloak.token);\n\n    setTimeout(() => {\n        keycloak.updateToken(70).success((refreshed) => {\n            if (refreshed) {\n                console.debug('Token refreshed' + refreshed);\n            } else {\n                console.warn('Token not refreshed, valid for '\n                    + Math.round(keycloak.tokenParsed.exp + keycloak.timeSkew - new Date().getTime() / 1000) + ' seconds');\n            }\n        }).error(() => {\n            console.error('Failed to refresh token');\n        });\n\n\n    }, 60000)\n\n}).error(() => {\n    console.error(\"Authenticated Failed\");\n});\n\n\n\nfunction LogOut(){\n    const logout = ()=>{\n      sessionStorage.clear();\n        window.location.href = 'http://localhost:8180/realms/petshoprealm/protocol/openid-connect/logout';\n    };\n\n    return (\n     <>\n        <button  onClick={logout}>\n          Logout\n        </button>\n    </>\n\n    );\n}\n\n// ReactDOM.render(<LogOut />, document.getElementById(\"logoutBtn\"));\n\n\n\nfunction CheckRoles() {\n  const check = () => {\n    $.ajax({\n      type: \"GET\",\n      url: \"http://localhost:9000/catalog/list?pageNo=1&pageSize=10\",\n      headers : {\n         'Authorization': 'Bearer ' + localStorage.getItem(\"bearer-token\"),\n      //   'Access-Control-Allow-Origin' : '*'\n      },\n      success: function (data1) {\n        document.getElementById(\"admin\").innerHTML = data1;\n      },\n      error: function (error) {\n        document.getElementById(\"admin\").innerHTML = \"You dont have admin privilages\";\n      }\n    });\n    // $.ajax({\n    //   type: \"GET\",\n    //   url: \"http://localhost:8080/check/admin\",\n    //   headers : {\n    //      'Authorization': 'Bearer ' + localStorage.getItem(\"bearer-token\")\n    //   },\n    //   success: function (data1) {\n    //     document.getElementById(\"admin\").innerHTML = data1;\n    //   },\n    //   error: function (error) {\n    //     document.getElementById(\"admin\").innerHTML = \"You dont have admin privilages\";\n    //   }\n    // });\n\n    // $.ajax({\n    //   type: \"GET\",\n    //   url: \"http://localhost:8080/check/customer\",\n    //   headers : {\n    //      'Authorization': 'Bearer ' + localStorage.getItem(\"bearer-token\")\n    //   },\n    //   success: function (data2) {\n    //     document.getElementById(\"cust\").innerHTML = data2;\n    //   },\n    //   error: function (error) {\n    //     document.getElementById(\"cust\").innerHTML = \"You dont have customer privilages\";\n    //   }\n    // });\n\n\n  };\n\n  return (\n    <>\n      <p> Check Admin privilages at <strong>/check/admin</strong> and check Customer privilages at <strong>/check/customer</strong>\n      </p>\n      <button onClick={check} >\n        Check \n      </button>\n      <p id=\"admin\"> </p>\n      <p id=\"cust\"> </p>\n    </>\n  );\n}\n\nReactDOM.render(<App />, document.getElementById('root'));\nserviceWorker.unregister();\n\n// ReactDOM.render(<CheckRoles />, document.getElementById(\"root\"));\n\n\n"]},"metadata":{},"sourceType":"module"}